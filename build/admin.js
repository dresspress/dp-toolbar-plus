!function(){"use strict";var e={};function t(){return(t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e}).apply(this,arguments)}e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,{a:o}),o},e.d=function(t,o){for(var l in o)e.o(o,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:o[l]})},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var o=window.wp.element,l=window.wp.domReady,a=e.n(l),n=window.wp.api,r=e.n(n),s=window.wp.i18n,i=window.wp.components,c=window.wp.data,d=window.wp.notices,p=window.lodash,u=e.n(p);const _=()=>{const e=(0,c.useSelect)((e=>e(d.store).getNotices().filter((e=>"snackbar"===e.type))),[]),{removeNotice:t}=(0,c.useDispatch)(d.store);return(0,o.createElement)(i.SnackbarList,{className:"dp-toolbar-settings-notices",notices:e,onRemove:t})};let b=[],m=[];const g=dpToolbarSettings,h=dpToolbarSettings.roles;for(const[e,t]of Object.entries(h))b.push({label:t.name,value:e}),m=m.concat(Object.keys(t.capabilities));m=u().uniq(m);const v=({label:e="",onChange:t,active:l=!1,action:a="",logged_in:n=!1,not_logged_in:r=!0,roles:c=[],caps:d=[],scope:p=""})=>(0,o.createElement)(o.Fragment,null,(0,o.createElement)(i.CheckboxControl,{label:(0,s.__)("Enable display rule for front-end Toolbar","dp-toolbar-plus"),checked:l,onChange:e=>{t({active:e})}}),l&&(0,o.createElement)("div",{className:"dp-toolbar-display-rule"},(0,o.createElement)(i.__experimentalHStack,{align:"center",justify:"flex-start"},(0,o.createElement)(i.SelectControl,{labelPosition:"side",value:a,options:[{label:(0,s.__)("Show Toolbar","dp-toolbar-plus"),value:"show"},{label:(0,s.__)("Hide Toolbar","dp-toolbar-plus"),value:"hide"}],onChange:e=>{t({action:e})}}),(0,o.createElement)(i.SelectControl,{labelPosition:"side",value:p,options:[{label:(0,s.__)("for all users","dp-toolbar-plus"),value:"all"},{label:(0,s.__)("for all users except administrators","dp-toolbar-plus"),value:"not_admins"},{label:(0,s.__)("for logged in users","dp-toolbar-plus"),value:"logged_in"},{label:(0,s.__)("for non-logged in users","dp-toolbar-plus"),value:"not_logged_in"},{label:(0,s.__)("for custom user scope","dp-toolbar-plus"),value:"custom"}],onChange:e=>{t({scope:e})}})),"custom"==p&&(0,o.createElement)("div",{className:"dp-toolbar-custom-scope"},(0,o.createElement)(i.CheckboxControl,{label:(0,s.__)("All non-logged in users","dp-toolbar-plus"),checked:r,onChange:e=>{t({not_logged_in:e})}}),(0,o.createElement)(i.CheckboxControl,{label:(0,s.__)("All logged in users ","dp-toolbar-plus"),checked:n,onChange:e=>{t({logged_in:e})}}),n&&(0,o.createElement)("div",{className:"dp-toolbar-roles-control"},(0,o.createElement)("label",null,(0,s.__)("with one of selected roles:","dp-toolbar-plus")),(0,o.createElement)("div",{className:"dp-toolbar-roles-option-list"},b.map(((e,l)=>(0,o.createElement)(i.CheckboxControl,{key:l,label:e.label,checked:c.includes(e.value),value:e.value,onChange:o=>{c=o?u().union(c,[e.value]):u().without(c,e.value),t({roles:c})}}))))),n&&(0,o.createElement)("div",{className:"dp-toolbar-caps-control"},(0,o.createElement)(i.FormTokenField,{label:(0,s.__)("AND have one of selected capabilities:","textdomai"),value:d,placeholder:(0,s.__)("e.g. manage_options"),suggestions:m,tokenizeOnSpace:!0,onChange:e=>{t({caps:e})},__experimentalExpandOnFocus:!0,__experimentalValidateInput:e=>m.includes(e)})))));class w extends o.Component{constructor(){super(...arguments),this.state={front_display_rule:g.front_display_rule,disable_user_pref:g.disable_user_pref,auto_hide_show:g.auto_hide_show,remove_wp_logo:g.remove_wp_logo,isSaving:!1}}componentDidMount(){}render(){const{front_display_rule:e,admin_display_rule:l,disable_user_pref:a,auto_hide_show:n,remove_wp_logo:d,isSaving:p}=this.state;return(0,o.createElement)(o.Fragment,null,(0,o.createElement)("div",{className:"dp-admin-page-header"},(0,o.createElement)("div",{className:"dp-admin-page-header-container"},(0,o.createElement)("h1",{className:"dp-admin-page-title"},(0,s.__)("Toolbar Settings","dp-toolbar-plus")))),(0,o.createElement)("div",{className:"dp-admin-page-body"},(0,o.createElement)("div",{className:"dp-admin-page-content"},(0,o.createElement)(i.Panel,null,(0,o.createElement)(i.PanelBody,{opened:!0,title:(0,s.__)("General","dp-toolbar-plus")},(0,o.createElement)(i.CheckboxControl,{label:(0,s.__)("Remove WP logo from toolbar","dp-toolbar-plus"),checked:d,onChange:e=>{this.setState({remove_wp_logo:e})}})),(0,o.createElement)(i.PanelBody,{opened:!0,title:(0,s.__)("Front-end Toolbar","dp-toolbar-plus")},(0,o.createElement)(v,t({label:(0,s.__)("Front-end Toolbar display rule","dp-toolbar-plus")},e,{onChange:t=>{this.setState({front_display_rule:{...e,...t}})}})),(0,o.createElement)(i.CheckboxControl,{label:(0,s.__)("Force disable Toolbar preference from Edit Profile page","dp-toolbar-plus"),checked:a,onChange:e=>{this.setState({disable_user_pref:e})}}),(0,o.createElement)(i.CheckboxControl,{label:(0,s.__)("Automatically hide and show the toolbar","dp-toolbar-plus"),checked:n,onChange:e=>{this.setState({auto_hide_show:e})}}))),(0,o.createElement)("p",{className:"dp-admin-page-save-settings"},(0,o.createElement)(i.Button,{isPrimary:!0,isBusy:p,onClick:()=>{this.setState({isSaving:!0}),new(r().models.Settings)({dp_toolbar_settings:{front_display_rule:e,disable_user_pref:a,auto_hide_show:n,remove_wp_logo:d}}).save().then((()=>{this.setState({isSaving:!1}),(0,c.dispatch)("core/notices").createNotice("success",(0,s.__)("Settings saved.","dp-toolbar-plus"),{type:"snackbar",isDismissible:!0,id:"save-settings-notice",actions:[{url:"/",label:(0,s.__)("View site")}]})})).catch((e=>{console.error("Error:",e)}))}},p?(0,s.__)("Saving","dp-toolbar-plus"):(0,s.__)("Save Settings","dp-toolbar-plus")))),(0,o.createElement)(_,null)))}}a()((()=>{const e=document.getElementById("dp-toolbar-settings-page-wrap");e&&(0,o.render)((0,o.createElement)(w,null),e)}))}();